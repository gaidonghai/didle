"use strict";(self["webpackChunkdidle"]=self["webpackChunkdidle"]||[]).push([[203],{1203:(e,t,i)=>{i.r(t),i.d(t,{default:()=>U});var n=i(3673),s=i(2323);const l={class:"column justify-center items-center"},a={class:"q-ma-md"},o={width:"200",height:"200"},r=["points"],c={class:"row"},d=(0,n.Uk)("分享结果"),u=(0,n.Uk)("随机新局"),p={style:{color:"grey"}};function h(e,t,i,h,m,g){const w=(0,n.up)("q-table"),f=(0,n.up)("q-select"),y=(0,n.up)("q-btn"),b=(0,n.up)("q-page");return(0,n.wg)(),(0,n.j4)(b,null,{default:(0,n.w5)((()=>[(0,n._)("div",l,[(0,n._)("div",a,[((0,n.wg)(),(0,n.iD)("svg",o,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.polygons,((e,t)=>((0,n.wg)(),(0,n.iD)("polygon",{key:t,points:e,fill:"#111111"},null,8,r)))),128))]))]),(0,n._)("div",null,[e.answers.length?((0,n.wg)(),(0,n.j4)(w,{key:0,rows:e.answers,columns:e.columnDef,separator:"none",pagination:{rowsPerPage:0},"hide-header":"","hide-bottom":"",flat:"",dense:""},null,8,["rows","columns"])):(0,n.kq)("",!0)]),(0,n._)("div",null,[(0,n.Wm)(f,{outlined:"",modelValue:e.userInput,"onUpdate:modelValue":[t[0]||(t[0]=t=>e.userInput=t),e.select],"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",options:e.currentOptions,onFilter:e.filterFn,"emit-value":"","map-options":"",label:"输入名称或拼音检索",dense:"","options-dense":""},null,8,["modelValue","options","onFilter","onUpdate:modelValue"])]),(0,n._)("div",c,[(0,n.Wm)(y,{class:"q-ma-sm",color:"secondary",onClick:e.copyClipboardGame},{default:(0,n.w5)((()=>[d])),_:1},8,["onClick"]),(0,n.Wm)(y,{class:"q-ma-sm",color:"primary",onClick:e.initialize},{default:(0,n.w5)((()=>[u])),_:1},8,["onClick"])]),(0,n._)("span",p,(0,s.zw)(e.currentUrl()),1)])])),_:1})}i(71),i(6016);var m=i(8825),g=i(1914);const w=(0,n.aZ)({name:"PageIndex",data(){return{cities:[],id:null,polygons:[],options:[],currentOptions:[],answers:[],userInput:"",notification:()=>{}}},setup(){let e=[];e.push({name:"attempt",label:"",field:e=>e.attempt,style:"padding-right:16px",align:"center"});for(let t=0;t<5;t++)e.push({name:String(t),label:"",field:(e=>t=>t.message[e])(t),style:"width:18px;"+(t<4?"padding:0":"padding-left:0"),align:"center"});return{quasar:(0,m.Z)(),columnDef:e}},async mounted(){this.cities=(await this.$api.get("/all")).data,this.currentOptions=this.options=this.cities.map(((e,t)=>({value:t,label:e.fullCH,search:e.fullCH+e.cityPY+e.cityInitialPY})));let e=new URLSearchParams(window.location.search);await this.initialize(e.get("id")||this.$route.params.id)},methods:{async initialize(e){e=Number(e),e||(e=Math.floor(1e6*Math.random())),this.polygons=[],this.answers=[],this.id=e,this.polygons=(await this.$api.get(`/svgPolygons/${this.id}`)).data;let t=this.cities[e%this.cities.length];console.log(`Game initialized with: ${e} (${t.fullCH})`)},currentUrl(){return window.location.origin+"/?id="+this.id},filterFn(e,t,i){t((()=>{const t=e.toLowerCase();this.currentOptions=this.options.filter((e=>e.search.toLowerCase().indexOf(t)>-1))}))},select(e){let t=this.cities[e],i=t.fullCH;console.log(`User selected: ${e} (${i})`),this.$api.get(`/${e}/${this.id}`).then((e=>{let t=e.data.distance,n=e.data.direction,s=n?"⬆↗➡↘⬇↙⬅↖⬆"[Math.round(n/45)]:"",l=Math.min(Math.ceil(Math.log(t/150+1)/Math.log(2)),5),a=Array(l).fill(s).join("")+Array(5-l).fill("✅").join("");console.log({distance:t,direction:n,message:a}),this.answers.push({attempt:i,message:a}),this.userInput=""}))},copyClipboardGame(){let e=[].concat("#Didle "+this.id).concat(this.answers.map((e=>e.message))).concat(this.currentUrl()).join("\n");(0,g.Z)(e).then((()=>{this.notification(),this.notification=this.quasar.notify({message:"已复制到剪贴板",color:"green",position:"top",timeout:1e3})})).catch((e=>{alert(e)}))}}});var f=i(4260),y=i(4379),b=i(2659),C=i(6934),k=i(4607),v=i(7518),$=i.n(v);const q=(0,f.Z)(w,[["render",h]]),U=q;$()(w,"components",{QPage:y.Z,QTable:b.Z,QSelect:C.Z,QBtn:k.Z})}}]);